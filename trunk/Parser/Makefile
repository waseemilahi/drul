OC = ocamlc
CFLAGS = # none for now

OBJS = drul_scanner.cmo drul_parser.cmo drul_types.cmo \
	drul_helpers.cmo drul_output.cmo drul_main.cmo 
LIBS = str.cma unix.cma

all : $(OBJS) drul

testing: test.cmo $(OBJS)
	$(OC) $(CFLAGS) -o testing $(LIBS) $(OBJS) test.cmo

treedump: treedump.cmo $(OBJS)
	$(OC) $(CFLAGS) -o treedump $(LIBS) $(OBJS) drul_printer.cmo treedump.cmo

scantest: drul_scanner.cmo scantest.cmo
	$(OC) $(CFLAGS) -o scantest $(LIBS) $<

drul: drul_interpreter.cmo $(OBJS) drul_ast.cmi
	$(OC) $(CFLAGS) -o drul $(LIBS) $(OBJS) drul_interpreter.cmo

drul_scanner.ml : drul_scanner.mll
	ocamllex $<

drul_parser.ml drul_parser.mli : drul_parser.mly
	ocamlyacc $<

%.cmo : %.ml
	$(OC) $(CFLAGS) -c $<

%.cmi : %.mli
	$(OC) $(CFLAGS) -c $<

.PHONY : clean
clean :
	rm -f  drul_parser.ml drul_parser.mli drul_scanner.ml *.cmo *.cmi testing treedump drul

# Generated by ocamldep *.ml *.mli
drul_helpers.cmo: drul_types.cmo drul_ast.cmi 
drul_helpers.cmx: drul_types.cmx drul_ast.cmi 
drul_interpreter.cmo: drul_types.cmo drul_scanner.cmo drul_parser.cmi \
    drul_main.cmo drul_ast.cmi 
drul_interpreter.cmx: drul_types.cmx drul_scanner.cmx drul_parser.cmx \
    drul_main.cmx drul_ast.cmi 
drul_main.cmo: drul_types.cmo drul_helpers.cmo drul_ast.cmi 
drul_main.cmx: drul_types.cmx drul_helpers.cmx drul_ast.cmi 
drul_output.cmo: drul_types.cmo drul_helpers.cmo 
drul_output.cmx: drul_types.cmx drul_helpers.cmx 
drul_parser.cmo: drul_ast.cmi drul_parser.cmi 
drul_parser.cmx: drul_ast.cmi drul_parser.cmi 
drul_printer.cmo: drul_ast.cmi 
drul_printer.cmx: drul_ast.cmi 
drul_scanner.cmo: drul_parser.cmi 
drul_scanner.cmx: drul_parser.cmx 
drul_types.cmo: drul_ast.cmi 
drul_types.cmx: drul_ast.cmi 
test.cmo: drul_scanner.cmo drul_parser.cmi drul_ast.cmi 
test.cmx: drul_scanner.cmx drul_parser.cmx drul_ast.cmi 
treedump.cmo: drul_scanner.cmo drul_printer.cmo drul_parser.cmi 
treedump.cmx: drul_scanner.cmx drul_printer.cmx drul_parser.cmx 
drul_parser.cmi: drul_ast.cmi 
